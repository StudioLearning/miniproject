@using Contentful.Core.Models
@using miniproject.Models.Contentful
@using Microsoft.AspNetCore.Identity
@using miniproject.Models

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@model Lesson

@{
    ViewData["Title"] = "Order";
    Lesson lesson = Model;
    int TotalPrice = (int)lesson.price + 35;
}

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a class="text-decoration-none" asp-area="" asp-controller="Home"
                asp-action="Index"><i class="fas fa-home"></i> หน้าแรก</a></li>
        <li class="breadcrumb-item"><a class="text-decoration-none" asp-area="" asp-controller="Course"
                asp-action="Index">คอร์ส</a>
        </li>
        <li class="breadcrumb-item" aria-current="page"><a class="text-decoration-none" asp-area=""
                asp-controller="Course" asp-action="GetCourse" asp-route-id="@lesson?.sku">
                @lesson?.sku</a></li>
        <li class="breadcrumb-item active" aria-current="page"> Order</li>
    </ol>
</nav>

<div class="row pt-4 pb-4 justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
        <div class="card w-80">
            <img src="@lesson?.image?.File.Url" class="card-img-top" alt="Course">
            <div class="card-body">
                <h5 class="card-title pb-3">รายการคำสั่งซื้อ</h5>
                <p class="card-text">
                    <b>วิชา</b> @lesson?.name
                </p>
                <p class="card-text">
                    <b>รหัสคอร์ส</b> @lesson?.sku
                </p>
                <p class="card-text">
                    <b>ผู้สอน</b> @lesson?.teacher?.teacherName
                </p>
                <div class="text-end">

                    <p class="card-text">
                        <b>ราคา</b> @lesson?.price บาท
                    </p>
                    <p class="card-text">
                        <b>ภาษี</b> 35 บาท
                    </p>
                    <p class="card-text">
                        <b>รวม</b> @TotalPrice บาท
                    </p>
                </div>
                <p class="text-center">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
                        กดสั่งซื้อ
                    </button>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">ยืนยันการสั่งซื้อ @lesson?.sku</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                กรุณากดปุ่มยืนยันเพื่อสั่งซื้อคอร์ส @lesson?.name ราคา @TotalPrice บาท
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ยกเลิก</button>
                <a asp-area="" asp-controller="Payment" asp-action="Course" asp-route-id="@lesson?.sku"
                    class="btn btn-primary text-decoration-none">ยืนยัน</a>
            </div>
        </div>
    </div>
</div>
